---
import { type CollectionEntry, getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: post,
  }));
}
type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content } = await post.render();
---

<Layout>
  <article class="mx-auto max-w-3xl">
    <div class="mb-12 text-center">
      <div
        class="mb-4 text-sm font-bold uppercase tracking-widest text-gray-400"
      >
        {
          post.data.pubDate.toLocaleDateString('en-us', {
            year: 'numeric',
            month: 'short',
            day: 'numeric',
          })
        }
      </div>
      <h1
        class="mb-6 text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl"
      >
        {post.data.title}
      </h1>
      <hr class="mx-auto my-8 h-px w-24 border-0 bg-gray-200" />
    </div>

    {
      post.data.heroImage && (
        <div class="mb-12 overflow-hidden rounded-3xl shadow-sm">
          <img
            width={1020}
            height={510}
            src={post.data.heroImage.src}
            alt=""
            class="w-full object-cover"
          />
        </div>
      )
    }

    <div class="prose prose-lg prose-gray mx-auto">
      <Content />
    </div>
  </article>
</Layout>
