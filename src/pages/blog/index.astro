---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const categoryLabels = {
  book: 'Book',
  tech: 'Tech',
};
---

<Layout>
  <main class="mx-auto w-[960px]">
    <section>
      <ul class="flex flex-wrap gap-8 list-none m-0 p-0 max-[720px]:gap-2">
        {
          posts.map((post) => (
            <li class="w-[calc(50%-1rem)] max-[720px]:w-full max-[720px]:text-center">
              <a
                href={`/blog/${post.slug}/`}
                class="block no-underline group transition-all duration-200"
              >
                <div class="flex items-center gap-2 mb-1 flex-wrap justify-center max-[720px]:justify-center">
                  <span class="text-xs font-semibold uppercase tracking-wider px-2 py-0.5 rounded bg-token-category text-token-category">
                    {categoryLabels[post.data.category]}
                  </span>
                  <span class="text-xs text-token-date">
                    {post.data.pubDate.toLocaleDateString('en-us', {
                      year: 'numeric',
                      month: 'short',
                      day: 'numeric',
                    })}
                  </span>
                </div>
                <h4 class="m-0 text-token-primary leading-none group-hover:text-token-secondary transition-colors">
                  {post.data.title}
                </h4>
                {post.data.tags.length > 0 && (
                  <div class="flex flex-wrap gap-1.5 mt-2 justify-center max-[720px]:justify-center">
                    {post.data.tags.map((tag) => (
                      <span class="text-[11px] px-2 py-0.5 rounded-full bg-token-tertiary text-token-secondary">
                        #{tag}
                      </span>
                    ))}
                  </div>
                )}
              </a>
            </li>
          ))
        }
      </ul>
    </section>
  </main>
</Layout>
